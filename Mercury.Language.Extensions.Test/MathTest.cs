// Copyright (c) 2017 - presented by Kei Nakai
//
// Original project is developed and published by OpenGamma Inc.
//
// Copyright (C) 2012 - present by OpenGamma Inc. and the OpenGamma group of companies
//
// Please see distribution for license.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
// 
//     http://www.apache.org/licenses/LICENSE-2.0
//     
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using NUnit.Framework;
using Mercury.Test.Utility;
using Mercury.Language.Math.Transform.FFT;

namespace Mercury_Language_Extensions.Test
{
    /// <summary>
    /// MathTest Description
    /// </summary>
    public class MathTest
    {
        [Test]
        public void DoubleFFT_1D_Test()
        {
            double eps = 1e-14;

            double[] h = new double[] { -0.6609555299345411, 0.274435217712937, 0.83901613083534388, 1, 0.83901613083533411, 0.27443521771292378, -0.66095552993454687, -1.4421573764774402, -1.3090169943749439, -0.09510483350093768, 1.3275859419297307, 1.7109783324311461, 0.67549882157700736, -0.80901699437495456, -1.355103473350231, -0.58929660082337165, 0.48235698913462655, 0.62912592927871214, -0.19098300562507181, -0.78243843326580664, -0.148574639345316, 1.2020049028711177, 1.6575085265867637, 0.30901699437490671, -1.81692000564894, -2.5981218521917913, -1.0004127617843865, 1.6905747139655447, 3, 1.6905747139654093, -1.0004127617845169, -2.5981218521918077, -1.8169200056488428, 0.3090169943750134, 1.6575085265867784, 1.2020049028710584, -0.1485746393453814, -0.78243843326579676, -0.1909830056250259, 0.62912592927873967, 0.4823569891345828, -0.58929660082342827, -1.3551034733502438, -0.809016994374911, 0.67549882157708119, 1.7109783324311683, 1.3275859419296789, -0.095104833501022723, -1.3090169943749821, -1.4421573764774238, -0.66095552993449058, 0.27443521771296409, 0.83901613083535853, 1, 0.83901613083531223, 0.27443521771288959, -0.66095552993458651, -1.4421573764774593, -1.3090169943749133, -0.095104833500878283, 1.3275859419297791, 1.7109783324311323, 0.675498821576947, -0.80901699437500829, -1.355103473350229, -0.58929660082331314, 0.48235698913465963, 0.62912592927868927, -0.19098300562511522, -0.7824384332658052, -0.14857463934526893, 1.202004902871175, 1.6575085265867395, 0.30901699437481323, -1.8169200056490074, -2.5981218521917695, -1.000412761784272, 1.6905747139656406, 3, 1.6905747139653138, -1.0004127617846237, -2.5981218521918272, -1.8169200056487624, 0.30901699437510005, 1.6575085265868008, 1.202004902871006, -0.14857463934543813, -0.78243843326579732, -0.19098300562497822, 0.62912592927875877, 0.48235698913455183, -0.58929660082347479, -1.3551034733502476, -0.80901699437484975, 0.675498821577145, 1.7109783324311891, 1.3275859419296334, -0.095104833501087449, -1.3090169943750127, -1.4421573764774098, -0.66095552993444906, 0.27443521771299878, 0.83901613083536453, 1, 0.8390161308353038, 0.274435217712855, -0.66095552993462825, -1.4421573764774831, -1.30901699437488, -0.095104833500811892, 1.3275859419298255, 1.7109783324311207, 0.67549882157687635, -0.80901699437506469, -1.3551034733502187, -0.58929660082326729, 0.48235698913468295, 0.62912592927867139, -0.19098300562514497, -0.78243843326580387, -0.14857463934522697, 1.2020049028712085, 1.6575085265867271, 0.30901699437474706, -1.8169200056490662, -2.5981218521917575, -1.0004127617842018, 1.6905747139657139, 3, 1.6905747139652481, -1.0004127617846956, -2.59812185219184, -1.8169200056487178, 0.30901699437514957, 1.6575085265868137, 1.2020049028709794, -0.14857463934546367, -0.78243843326579565, -0.19098300562496173, 0.6291259292787621, 0.48235698913453751, -0.58929660082349378, -1.3551034733502547, -0.80901699437483154, 0.67549882157717012, 1.7109783324311949, 1.3275859419296163, -0.095104833501109765, -1.3090169943750229, -1.4421573764773989, -0.66095552993443674, 0.27443521771301377, 0.83901613083537241, 1, 0.83901613083529913, 0.27443521771284635, -0.66095552993464324, -1.4421573764774869, -1.3090169943748666, -0.095104833500786135, 1.3275859419298452, 1.7109783324311181, 0.67549882157685348, -0.80901699437508512, -1.3551034733502187, -0.58929660082325008, 0.4823569891346956, 0.62912592927866429, -0.190983005625166, -0.78243843326580309, -0.14857463934519788, 1.2020049028712361, 1.6575085265867178, 0.30901699437470043, -1.8169200056491079, -2.5981218521917486, -1.0004127617841385, 1.690574713965777, 3, 1.6905747139651943, -1.0004127617847571, -2.59812185219185, -1.8169200056486683, 0.30901699437520458, 1.6575085265868243, 1.2020049028709512, -0.14857463934549864, -0.78243843326579843, -0.19098300562493481, 0.62912592927877187, 0.4823569891345163, -0.58929660082352986, -1.355103473350256, -0.80901699437478736, 0.67549882157722929, 1.7109783324312138, 1.3275859419295728, -0.0951048335011665, -1.3090169943750471, -1.4421573764773743, -0.6609555299343991, 0.27443521771303447, 0.839016130835385, 1, 0.83901613083528637, 0.27443521771281942, -0.66095552993467777, -1.4421573764775084, -1.3090169943748344, -0.095104833500734509, 1.3275859419298852, 1.7109783324311008, 0.67549882157679864, -0.80901699437513208, -1.3551034733502147, -0.58929660082320479, 0.482356989134726, 0.629125929278643, -0.19098300562520198, -0.78243843326580109, -0.14857463934515669, 1.2020049028712876, 1.6575085265866956, 0.30901699437462893, -1.8169200056491766, -2.5981218521917282, -1.0004127617840437, 1.6905747139658556, 3, 1.6905747139651235, -1.0004127617848346, -2.5981218521918619, -1.8169200056486199, 0.30901699437526092, 1.6575085265868394, 1.2020049028709081, -0.14857463934554427, -0.7824384332657851, -0.19098300562489562, 0.62912592927879329, 0.48235698913448843, -0.58929660082357627, -1.3551034733502605, -0.80901699437475239, 0.67549882157727492, 1.7109783324312224, 1.3275859419295408, -0.095104833501219121, -1.3090169943750642, -1.4421573764773694, -0.66095552993436668, 0.27443521771306539, 0.83901613083539539, 1, 0.83901613083528026, 0.27443521771279417 };

            double[] res = new double[] { 2.5659471671620757, 0.0, 2.568465822758921, 7.194245199571014E-14, 2.576051712720573, 4.551914400963142E-14, 2.588795530941984, 4.39648317751562E-14, 2.6068515699129664, 7.105427357601002E-15, 2.6304426215631977, 1.1546319456101628E-14, 2.659867252015869, 2.886579864025407E-14, 2.6955099131788534, 1.354472090042691E-14, 2.7378545651410917, 6.128431095930864E-14, 2.7875027698038104, 4.951594689828198E-14, 2.8451976173246014, 1.0058620603103918E-13, 2.9118554230666205, 1.3988810110276972E-13, 2.988607978852613, 7.904787935331115E-14, 3.0768594118618493, 1.2878587085651816E-13, 3.178363651334703, 1.20570220474292E-13, 3.2953315583555427, 5.88418203051333E-14 };

            int n = h.Length;
            double[] a = h.CopyOf(2 * n);

            DoubleFFT_1D fft = new DoubleFFT_1D(n);
            fft.RealForwardFull(a);

            for (int i = 0; i < res.Length; i++)
            {
                Assert.AreEqual(a[i], res[i], eps);
            }
        }
    }
}
